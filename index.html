<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Volleyball Tournaments — Canada</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* same styling as before — keeping it short */
    :root{--sidebar-w:260px;--accent:#2c7be5;--bg:#f4f6f8;}
    body{margin:0;font-family:system-ui;background:var(--bg);color:#222;}
    .container{display:flex;min-height:100vh}
    .sidebar{width:var(--sidebar-w);background:#1f2a44;color:#fff;padding:20px;overflow:auto}
    .province-list{list-style:none;padding:0}
    .province{margin-bottom:6px}
    .province>button,.region-button{background:none;border:0;color:#fff;cursor:pointer;text-align:left;padding:6px}
    .regions{display:none;margin-left:12px}
    .content{flex:1;padding:28px}
    .table-wrap{background:#fff;border-radius:8px;padding:14px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #eee}
    .tag{padding:2px 6px;background:#eef;color:#224;border-radius:4px;font-size:12px}
    a.link{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
  <div class="container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <h2>Provinces & Regions</h2>
      <button id="show-all">Show All</button>
      <ul class="province-list" id="provinceList"></ul>
    </aside>

    <!-- Main -->
    <main class="content">
      <h1>Upcoming Volleyball Events</h1>
      <div class="table-wrap">
        <table id="eventsTable">
          <thead>
            <tr>
              <th>Date</th>
              <th>Event</th>
              <th>City / Region</th>
              <th>Province</th>
              <th>Level</th>
              <th>Registration</th>
            </tr>
          </thead>
          <tbody>
            <!-- will be filled by JS -->
          </tbody>
        </table>
      </div>
    </main>
  </div>

  <script>
    const provinces = {
      "Ontario": ["Toronto","Ottawa","Hamilton","Waterloo Region","London"],
      "Quebec": ["Montreal","Quebec City","Sherbrooke","Gatineau"],
      "British Columbia": ["Vancouver","Victoria","Kelowna"],
      "Alberta": ["Calgary","Edmonton","Red Deer"],
      "Manitoba": ["Winnipeg"],
      "Saskatchewan": ["Saskatoon","Regina"],
      "Nova Scotia": ["Halifax","Sydney"],
      "New Brunswick": ["Moncton","Fredericton","Saint John"],
      "Prince Edward Island": ["Charlottetown"],
      "Newfoundland & Labrador": ["St. John's"],
      "Yukon": ["Whitehorse"],
      "Northwest Territories": ["Yellowknife"],
      "Nunavut": ["Iqaluit"]
    };

    const provinceListEl=document.getElementById('provinceList');
    const tableBody=document.querySelector('#eventsTable tbody');
    let eventsData=[];

    // Build sidebar
    Object.keys(provinces).forEach(prov=>{
      const li=document.createElement('li');li.className='province';
      const btn=document.createElement('button');btn.textContent=prov;btn.onclick=()=>applyFilter(prov,null);
      const regions=document.createElement('div');regions.className='regions';
      provinces[prov].forEach(region=>{
        const rbtn=document.createElement('button');rbtn.textContent=region;rbtn.className='region-button';
        rbtn.onclick=()=>applyFilter(prov,region);regions.appendChild(rbtn);
      });
      btn.addEventListener('click',()=>{regions.style.display=regions.style.display==='block'?'none':'block';});
      li.appendChild(btn);li.appendChild(regions);provinceListEl.appendChild(li);
    });

    document.getElementById('show-all').onclick=()=>applyFilter(null,null);

    // Load JSON file
    fetch('events.json')
      .then(res=>res.json())
      .then(data=>{
        eventsData=data;
        renderTable(eventsData);
      });

    function renderTable(events){
      tableBody.innerHTML='';
      if(events.length===0){
        tableBody.innerHTML='<tr><td colspan="6" style="text-align:center;padding:20px">No events available.</td></tr>';
        return;
      }
      events.forEach(ev=>{
        const tr=document.createElement('tr');
        tr.dataset.province=ev.province;tr.dataset.region=ev.region;
        tr.innerHTML=`
          <td>${ev.date}</td>
          <td>${ev.name}</td>
          <td>${ev.city} (${ev.region})</td>
          <td>${ev.province}</td>
          <td><span class="tag">${ev.level}</span></td>
          <td>${ev.registration?`<a href="${ev.registration}" class="link">Register</a>`:"—"}</td>`;
        tableBody.appendChild(tr);
      });
    }

    function applyFilter(province,region){
      if(!province&&!region){renderTable(eventsData);return;}
      const filtered=eventsData.filter(ev=>{
        if(province&&region){return ev.province===province&&ev.region===region;}
        if(province&&!region){return ev.province===province;}
        return true;
      });
      renderTable(filtered);
    }
  </script>
</body>
</html>
